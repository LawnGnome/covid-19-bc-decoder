(this["webpackJsonpcovid-19-bc-decoder"]=this["webpackJsonpcovid-19-bc-decoder"]||[]).push([[0],{1024:function(e,t){},1074:function(e,t,n){"use strict";n.r(t);var r,c=n(36),i=n.n(c),a=n(853),s=n.n(a),o=(n(869),n(64)),u=(n(870),n(864)),l=n(854),d=n(81),j=n(861),v=n(88),b=n(16);!function(e){e[e.SCANNING=0]="SCANNING",e[e.RESULTS=1]="RESULTS",e[e.ABOUT=2]="ABOUT"}(r||(r={}));var h=function(){var e=Object(c.useState)(void 0),t=Object(o.a)(e,2),n=t[0],i=t[1],a=Object(c.useState)(r.SCANNING),s=Object(o.a)(a,2),h=s[0],f=s[1],O=Object(c.useCallback)((function(e){e&&(i(e),f(r.RESULTS))}),[]),x=Object(c.useCallback)((function(){i(void 0),f(r.SCANNING)}),[]);return Object(c.useLayoutEffect)((function(){var e=function(){return document.documentElement.style.setProperty("--vh","".concat(window.innerHeight,"px"))};e(),window.onresize=e})),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{id:"nav",children:Object(b.jsxs)("nav",{children:[h!==r.SCANNING&&Object(b.jsx)("button",{onClick:x,children:Object(b.jsx)(d.a,{icon:v.a})}),Object(b.jsx)("div",{id:"spacer"}),h!==r.ABOUT&&Object(b.jsx)("button",{className:"about",onClick:function(){return f(r.ABOUT)},children:"About"}),Object(b.jsx)("a",{id:"github",target:"_blank",rel:"noreferrer",href:"https://github.com/LawnGnome/covid-19-bc-decoder",children:Object(b.jsx)(d.a,{icon:j.a})})]})}),h===r.ABOUT&&Object(b.jsxs)("div",{className:"content",children:[Object(b.jsx)("h2",{children:"About this site"}),Object(b.jsx)("p",{children:"This is a very quick and dirty site to decode and display the information encoded in a BC Vaccine Card."}),Object(b.jsx)("p",{children:"Your QR code and health information are not transmitted anywhere. (The coders among you can verify that using the source code below.)"}),Object(b.jsxs)("p",{children:["The source code for this site is hosted"," ",Object(b.jsx)("a",{href:"https://github.com/LawnGnome/covid-19-bc-decoder",children:"on GitHub"}),". Bug reports are welcome."]}),Object(b.jsxs)("p",{children:["If you want to contact the author, ping"," ",Object(b.jsx)("a",{href:"https://twitter.com/LGnome",children:"@LGnome"})," on Twitter."]})]}),h===r.SCANNING&&Object(b.jsx)("div",{id:"scanner",children:Object(b.jsx)(u.a,{onResult:function(e){return O(null===e||void 0===e?void 0:e.getText())},constraints:{facingMode:"environment"},videoStyle:{height:null,width:null,top:null,left:null,display:null,overflow:null,position:null},videoContainerStyle:{height:null,width:null,position:null,paddingTop:null,overflow:null}})}),h===r.RESULTS&&n&&Object(b.jsx)("div",{id:"results",className:"content",children:Object(b.jsx)(l.a,{code:n})})]})},f=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1075)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),i(e),a(e)}))};s.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(h,{})}),document.getElementById("root")),f()},173:function(e,t){},65:function(e,t,n){"use strict";n(36);var r=n(16);t.a=function(e){var t=e.label,n=e.value;return Object(r.jsx)(r.Fragment,{children:void 0!==n&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("dt",{children:t}),Object(r.jsx)("dd",{children:n})]})})}},75:function(e,t,n){e.exports={signature:"Signature_signature__3cbGP",verifying:"Signature_verifying__3_pMS",success:"Signature_success__qmBR2",failure:"Signature_failure__1hhGk",icon:"Signature_icon__3BkQB"}},854:function(e,t,n){"use strict";(function(e){var r=n(80),c=(n(36),n(855)),i=n(856),a=n(857),s=n(858),o=n(863),u=n(16);t.a=function(t){var n=t.code;n.startsWith("shc:/")&&(n=n.substr(5));var l=function(e){var t,n=void 0,c="",i=Object(r.a)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===n)n=a;else{var s=parseInt("".concat(n).concat(a))+45;c+=String.fromCharCode(s),n=void 0}}}catch(o){i.e(o)}finally{i.f()}return c}(n),d=JSON.parse(c.a.inflateRaw(e.from(l.split(".")[1],"base64"),{to:"string"}));try{var j=i.R4.RTTI_Bundle.decode(d.vc.credentialSubject.fhirBundle);if("Right"!==j._tag)throw j.left;var v,b=j.right;if(void 0===b.entry)throw new Error("no entries found in bundle");var h,f=[],O=Object(r.a)(b.entry);try{for(O.s();!(h=O.n()).done;){var x=h.value.resource;"Patient"===(null===x||void 0===x?void 0:x.resourceType)?v=x:"Immunization"===(null===x||void 0===x?void 0:x.resourceType)&&f.push(x)}}catch(p){O.e(p)}finally{O.f()}return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(o.a,{signature:l}),v&&Object(u.jsx)(a.a,{patient:v}),f.length>0&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h2",{children:"Vaccinations"}),f.map((function(e){return Object(u.jsx)(s.a,{immunisation:e})}))]})]})}catch(m){return Object(u.jsx)("div",{children:"The QR code had an unexpected structure, and could not be parsed. Try scanning another one?"})}}}).call(this,n(23).Buffer)},857:function(e,t,n){"use strict";n(36);var r=n(65),c=n(16);t.a=function(e){var t,n=e.patient;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{children:"Personal information"}),Object(c.jsxs)("dl",{children:[null===(t=n.name)||void 0===t?void 0:t.map((function(e){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(r.a,{label:"Family name",value:e.family}),Object(c.jsx)(r.a,{label:"Given names",value:e.given&&e.given.length>0?e.given.join(" "):void 0})]})})),Object(c.jsx)(r.a,{label:"Date of birth",value:n.birthDate})]})]})}},858:function(e,t,n){"use strict";var r=n(80),c=(n(36),n(65)),i=n(16),a=function(e){if(e){var t,n=Object(r.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;if("http://hl7.org/fhir/sid/cvx"===c.system)switch(c.code){case"510":return"Sinopharm";case"511":return"Sinovac";case"502":return"COVAXIN";case"501":return"QAZCOVID-IN";case"503":return"COVIVAC";case"500":return"Unknown COVID-19 vaccine";case"507":return"Anhui Zhifei Longcom Biopharm";case"509":return"EpiVacCorona";case"508":return"Jiangsu";case"211":return"Novavax";case"212":return"Janssen";case"210":return"AstraZeneca";case"506":return"CanSino";case"504":return"Sputnik Light";case"505":return"Sputnik V";case"207":return"Moderna";case"208":return"Pfizer"}}}catch(i){n.e(i)}finally{n.f()}}};t.a=function(e){var t,n=e.immunisation;return Object(i.jsxs)("dl",{children:[Object(i.jsx)(c.a,{label:"Date",value:n.occurrenceDateTime}),Object(i.jsx)(c.a,{label:"Type",value:a(n.vaccineCode.coding)}),Object(i.jsx)(c.a,{label:"Lot number",value:n.lotNumber}),Object(i.jsx)(c.a,{label:"Location",value:null===(t=n.performer)||void 0===t?void 0:t.map((function(e){return e.actor.display})).filter((function(e){return void 0!==e})).join("; ")})]})}},863:function(e,t,n){"use strict";var r,c=n(56),i=n.n(c),a=n(87),s=n(64),o=n(88),u=n(81),l=n(36),d=n(80),j=n(859),v=n(860),b=n(190),h={Quebec:{keys:[{alg:"ES256",kty:"EC",crv:"P-256",use:"sig",kid:"fFyWQ6CvV9Me_FkwWAL_DwxI_VQROw8tyzSp5_zI8_4",x:"XSxuwW_VI_s6lAw6LAlL8N7REGzQd_zXeIVDHP_j_Do",y:"88-aI4WAEl4YmUpew40a9vq_w5OcFvsuaKMxJRLRLL0"}]},"British Columbia":{keys:[{kty:"EC",kid:"XCqxdhhS7SWlPqihaUXovM_FjU65WeoBFGc_ppent0Q",use:"sig",alg:"ES256",crv:"P-256",x:"xscSbZemoTx1qFzFo-j9VSnvAXdv9K-3DchzJvNnwrY",y:"jA5uS5bz8R2nxf_TU-0ZmXq6CKWZhAG1Y4icAx8a9CA"}]}},f=new(function(){function e(){Object(j.a)(this,e),this.verifiers=void 0,this.verifiers=new Map}return Object(v.a)(e,[{key:"load",value:function(){var e=Object(a.a)(i.a.mark((function e(){var t,n,r,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.verifiers.size){e.next=15;break}t=0,n=Object.entries(h);case 2:if(!(t<n.length)){e.next=15;break}return r=Object(s.a)(n[t],2),c=r[0],a=r[1],e.t0=this.verifiers,e.t1=c,e.t2=b.JWS,e.next=9,b.JWK.asKeyStore(a);case 9:e.t3=e.sent,e.t4=e.t2.createVerify.call(e.t2,e.t3),e.t0.set.call(e.t0,e.t1,e.t4);case 12:t++,e.next=2;break;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,r,c,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(d.a)(this.verifiers),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=15;break}return c=Object(s.a)(r.value,2),a=c[0],o=c[1],e.prev=5,e.next=8,o.verify(t);case 8:return e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(5);case 13:e.next=3;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(1),n.e(e.t1);case 20:return e.prev=20,n.f(),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[1,17,20,23],[5,11]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()),O=function(){var e=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.load();case 2:return e.abrupt("return",f);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=n(75),p=n.n(x),m=n(16);!function(e){e[e.VERIFYING=0]="VERIFYING",e[e.VERIFIED=1]="VERIFIED",e[e.FAILED=2]="FAILED"}(r||(r={}));t.a=function(e){var t=e.signature,n=Object(l.useState)(r.VERIFYING),c=Object(s.a)(n,2),d=c[0],j=c[1],v=Object(l.useState)(void 0),b=Object(s.a)(v,2),h=b[0],f=b[1];return Object(l.useMemo)(Object(a.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return e.next=4,e.sent.verify(t);case 4:void 0!==(n=e.sent)?(f(n),j(r.VERIFIED)):(f(void 0),j(r.FAILED));case 6:case"end":return e.stop()}}),e)}))),[t]),Object(m.jsxs)("div",{className:p.a.signature,children:[d===r.VERIFYING&&Object(m.jsxs)("div",{className:p.a.verifying,children:[Object(m.jsx)("div",{className:p.a.icon,children:Object(m.jsx)(u.a,{icon:o.d,pulse:!0})}),Object(m.jsx)("div",{children:"Checking QR code signature\u2026"})]}),d===r.VERIFIED&&h&&Object(m.jsxs)("div",{className:p.a.success,children:[Object(m.jsx)(u.a,{className:p.a.icon,icon:o.b}),Object(m.jsxs)("div",{children:["QR code verified by ",h]})]}),d===r.FAILED&&Object(m.jsxs)("div",{className:p.a.failure,children:[Object(m.jsx)(u.a,{className:p.a.icon,icon:o.c}),Object(m.jsx)("div",{children:"QR code could not be verified by a known jurisdiction"})]})]})}},869:function(e,t,n){},870:function(e,t,n){}},[[1074,1,2]]]);
//# sourceMappingURL=main.589342fb.chunk.js.map